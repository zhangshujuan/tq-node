const ghost = require(process.argv[2] + '/tq-zjgrid-population/cfg/ghost.js'); //基础配置:log4j及dscm远程地址
const gapi = require(process.argv[2] + '/tq-zjgrid-population/cmn/gapi.js');

class List extends gapi.Objc {
  constructor() {
    super();

    //为了保证在func中使用this
    this.fun = this.fun.bind(this);
  }

  conf() {
    return {
      auth: false,
      type: 'json',
      itfs: [
        {
          meth: 'post',
          type: 'http',
          uuid: 'list',
          host: ghost.dscm.dccr.addr,
          port: ghost.dscm.dccr.port,
          iurl: '/basePplUnify/pageForPopulation',
          func: this.fun,
          next: []
        }
      ]
    };
  }
  fun(req,res,fld,fle) {
    const cardId = this.getParameter(req, 'cardId');
    const code = this.getParameter(req, 'code');
    const name = this.getParameter(req, 'name');
    const page = this.getParameter(req, 'page');
    const orgId = this.getParameter(req, 'orgId');
    const rows = this.getParameter(req, 'rows');
    const sidx = this.getParameter(req, 'sidx');
    const sord = this.getParameter(req, 'sord');
    const optMode = this.getParameter(req, 'optMode');
    return {
      "objv": {
        "cardId":cardId,
        "code":code,
        "name":name,
        "page":page,
        "orgId":orgId,
        "rows":rows,
        "sidx":sidx,
        "sord":sord,
        "optMode":optMode,
      } 
    };
  }
  out(req, res, fld, fle) {
    const rslt = this.rslt(req, 'list');
    console.log(rslt)
    return rslt.objv;
  }
}

//必须放在文件的最后面
exports = module.exports = List;
